<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editor.js ImageTool Example</title>
  <link rel="stylesheet" href="assets/css/editorjs.css">
</head>
<body>

<div id="editor_js"></div>

<!-- Image upload form -->
<form id="imageUploadForm" enctype="multipart/form-data">
  <label for="image">Upload Image:</label>
  <input type="file" id="image" name="image" accept="image/*">
  <button type="button" onclick="uploadImage()">Upload</button>
</form>

    <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/image@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/link@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/code@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const editor = new EditorJS({
      holder: 'editor_js',
      tools: {
        header: {
          class: Header,
          inlineToolbar: ['link'],
          config: {
            placeholder: 'Enter a header',
          },
        },
        list: {
          class: List,
          inlineToolbar: true,
        },
        image: {
          class: ImageTool,
          config: {
            endpoints: {
              byFile: 'assets/cgi/upload_image.py',
              byUrl: 'assets/cgi/fetch_image.py',
            },
          },
        },
      },
    });
  });

  // Function to handle image upload
  function uploadImage() {
    const formData = new FormData(document.getElementById('imageUploadForm'));

    // Send a POST request to your server for image upload
    fetch('/cgi-bin/upload_image.py', {
      method: 'POST',
      body: formData,
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        // Insert the uploaded image into the editor
        editor.blocks.insert('image', { url: data.file.url });
      } else {
        console.error('Image upload failed:', data.error);
      }
    })
    .catch(error => {
      console.error('Error during image upload:', error);
    });
  }
</script>

</body>
</html>
